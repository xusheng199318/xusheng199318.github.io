---
title: 异常控制流
date: 2018-12-23 15:04:45
tags: 操作系统
---

### 异常

> 异常是异常控制流的一种形式，它一部分由硬件实现，一部分由操作系统实现。异常就是控制流中的突变，用来响应处理器状态中的某些变化。

### 异常处理

> 系统中可能的每种异常都分配了一个唯一的非负整数的异常号
>
> 处理器分配：被0除、缺页、内存访问违例、断点及算数运算溢出
>
> 操作系统内核分配：系统调用和来自外部I/O设备的信号

### 异常的类别

中断、陷阱、故障和终止

### 进程

> 在现代系统上运行一个程序时，我们会得到一个假象，就好像我们的程序是系统中当前运行的唯一的程序一样。程序好像独占地使用CPU和内存。处理器好像无间断地一条接一条地执行程序中的指令。程序中的代码和数据好像是系统内存中唯一的对象。

### 用户模式和内核模式

> 处理器通过某个寄存器的`模式位`来控制程序从用户态到内核态的转换。
>
> 当设置了模式位时，进程就运行在内核模式中，一个运行在内核无中的进程可以执行指令集中的任何指令，并且可以访问系统中的任何内存位置。
>
> 没有设置模式位时，进程就运行在用户模式中。用户模式中的进程不允许执行`特权指令`，比如停止处理器、改变模式位，或者发起一个I/O操作。也不允许用户模式中的进程直接引用地址空间中内核区的代码和数据。任何这样的尝试都会导致致命的保护故障。

### 上下文切换

> 操作系统内核使用一种成为`上下文切换`的异常控制流来实现多人物。
>
> 内核为每一个进程维持一个上下文。上下文就是内核重新启动一个被抢占的进程所需的状态。它由通过目的`寄存器`、`浮点寄存器`、`程序计数器`、`用户栈`、`状态寄存器`、`内核栈`和各种内核数据结构，比如描述地址空间的`页表`、包含有关当前进程信息的`进程表`以及包含进程已打开文件的信息的`文件表`

